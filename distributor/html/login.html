<!DOCTYPE html>
<html lang="en" ng-app="distributorLoginApp">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng Nhập Nhà Phân Phối - GOLD 4.0</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        .swal2-popup {
            background: #fff;
            color: #333;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transform: scale(0.9);
            transition: transform 0.3s ease-in-out;
        }

        .swal2-popup.show {
            transform: scale(1);
        }

        .swal2-title {
            color: #f0b400;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .swal2-icon.swal2-success {
            border-color: #f0b400;
        }

        .swal2-icon.swal2-error {
            border-color: #f0b400;
        }

        .swal2-icon.swal2-warning {
            border-color: #f0b400;
        }

        .swal2-confirm {
            background-color: #f0b400;
            border: none;
            color: white;
            border-radius: 5px;
            padding: 10px 20px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .swal2-confirm:hover {
            background-color: #e1e09e;
        }

        .swal2-cancel {
            color: #333;
            border: none;
            background: transparent;
        }

        .swal2-cancel:hover {
            color: #f0b400;
        }
    </style>
</head>

<body ng-controller="LoginController">

    <div class="container-fluid p-0">
        <div class="row g-0">
            <!-- Cột bên trái chứa hình ảnh -->
            <div class="col-lg-7 col-md-6 col-12">
                <img src="https://www.karat.vn/uploads/images/cau-chuyen-ve-bieu-tuong-con-ran-trong-cac-thiet-ke-trang-suc-cua-bvlgari-3.jpg"
                    alt="" class="img-fluid w-100" style="height: 100vh; object-fit: cover;">
            </div>

            <!-- Cột bên phải chứa form -->
            <div class="col-lg-5 col-md-6 col-12 d-flex flex-column justify-content-center align-items-center">
                <!-- Tiêu đề GOLD - 4.0 -->
                <a href="/user/index.html" style="text-decoration: none;">
                    <h1 class="text-center" style="
                        font-family: 'Montserrat', sans-serif;
                        margin-top: 20px;
                        color: #f4f489;
                        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
                        letter-spacing: 2px;
                        background: linear-gradient(30deg, #ffffff, #FFA500);
                        -webkit-background-clip: text;
                        color: transparent;">
                        GOLD - 4.0
                    </h1>
                </a>

                <!-- Form Đăng Nhập -->
                <div class="login-container mt-4 w-75">
                    <header class="text-center">
                        <h4
                            style="font-family: 'Times New Roman', Times, serif; font-size: 30px; color: #333; letter-spacing: 1px;">
                            Đăng Nhập Nhà Phân Phối
                        </h4>
                    </header>
                    <form class="needs-validation" novalidate ng-submit="login()">
                        <div class="mb-3">
                            <label for="username" class="form-label" style="font-family: 'Times New Roman'">Tên Đăng
                                Nhập</label>
                            <input type="text" class="form-control" id="username" ng-model="username" required>
                            <div class="invalid-feedback">
                                Vui lòng điền tên đăng nhập
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label" style="font-family: 'Times New Roman'">Mật
                                khẩu</label>
                            <input type="password" class="form-control" id="password" ng-model="password" required>
                            <div class="invalid-feedback">
                                Vui lòng điền mật khẩu
                            </div>
                        </div>

                        <div class="mb-3 recaptcha-box">
                            <div class="g-recaptcha" data-sitekey="{{siteKey}}" data-callback="recaptchaCallback"></div>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">Lưu mật khẩu</label>
                        </div>
                        <div class=" mb-3">
                            <a href="" class="forgot-password-link" style="
                                font-family: 'Times New Roman';
                                color: #0c0c0c;
                                text-decoration: none;
                                font-size: 14px;
                                font-weight: 500;
                                transition: text-decoration 0.3s ease;">
                                Quên mật khẩu?
                            </a>
                        </div>
                        <button type="submit" class="btn btn-outline-dark w-100" style="height: 50px;">
                            <span class="button__label" style="
                                letter-spacing: .0852071047em;
                                font-family: VogueAvantGarde, helvetica, sans-serif;
                                font-size: 13px;
                                font-weight: 600;
                                text-transform: uppercase;">
                                Đăng Nhập
                            </span>
                        </button>

                    </form>
                    <hr>
                    <div class="d-flex justify-content-between w-75">
                        <p style="font-size: 16px; font-family: 'Times New Roman'; color: #666; margin-left: 0;">
                            Chưa Có Tài Khoản?
                            <a href="/distributor/html/register.html" class="login-link" style="
                                font-family: 'Times New Roman';
                                color: #0c0c0c;
                                font-weight: bold;
                                text-decoration: none;
                                position: relative;
                                padding-bottom: 3px;
                                border-bottom: 2px solid transparent;
                                transition: border-color 0.3s ease;">
                                Đăng Ký Ngay
                            </a>

                        </p>




                    </div>
                    <div class="d-flex justify-content-between w-75">
                        <!-- Thêm dòng điều khoản sử dụng -->
                        <p style="font-size: 16px; font-family: 'Times New Roman'; color: #666; margin-right: 0;">
                            <a href="/user/html/login.html" class="terms-link" style="
                            font-family: 'Times New Roman';
                            color: #0c0c0c;
                            font-weight: bold;
                            text-decoration: none;
                            position: relative;
                            padding-bottom: 3px;
                            border-bottom: 2px solid transparent;
                            transition: border-color 0.3s ease;">
                                Đăng Nhập -
                            </a>
                            <a href="/user/html/register.html" class="terms-link" style="
                                font-family: 'Times New Roman';
                                color: #0c0c0c;
                                font-weight: bold;
                                text-decoration: none;
                                position: relative;
                                padding-bottom: 3px;
                                border-bottom: 2px solid transparent;
                                transition: border-color 0.3s ease;">
                                Đăng Ký Tư Cách Người Dùng
                            </a>
                        </p>


                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            var app = angular.module('distributorLoginApp', []);

            app.controller('LoginController', ['$scope', '$http', function ($scope, $http) {
                $scope.recaptchaToken = null;
                $scope.siteKey = '6LexVlgqAAAAACJbJFXNT64FwRl5purGdSfnGJtp';  // Thay thế bằng site key của bạn

                window.recaptchaCallback = function (response) {
                    $scope.recaptchaToken = response;
                };

                $scope.login = function () {
                    const loginData = {
                        tenTK: $scope.username,
                        mathau: $scope.password,
                        recaptchaToken: $scope.recaptchaToken
                    };

                    console.log(loginData);
                    console.log($scope.recaptchaToken);

                    $http.post('http://localhost:9999/api/auth/distributor/login', loginData)
                        .then(function (response) {
                            // Thông báo thành công
                            Swal.fire({
                                icon: 'success',
                                title: 'Đăng nhập thành công!',
                                text: 'Chào mừng bạn đến với GOLD - 4.0!',
                                confirmButtonText: 'Đóng',
                                customClass: {
                                    confirmButton: 'swal2-confirm',
                                }
                            });
                            localStorage.setItem('distributorInfo', JSON.stringify(response.data.distributorInfo));
                            localStorage.setItem('token', response.data.token);
                            window.location.href = response.data.redirectUrl;
                        })
                        .catch(function (error) {
                            // Xử lý lỗi với SweetAlert2
                            let errorMessage = 'Đăng nhập thất bại. Vui lòng kiểm tra lại.';
                            if (error.data) {
                                errorMessage = error.data;
                            }
                            Swal.fire({
                                icon: 'error',
                                title: 'Đăng nhập thất bại',
                                text: 'Tài khoản hoặc mật khẩu không chính xác.',
                                confirmButtonText: 'Đóng',
                                customClass: {
                                    confirmButton: 'swal2-confirm',
                                }
                            });
                        });
                };
            }]);
        </script>

</body>

</html>